<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Resume Builder with ATS</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: auto;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #2c3e50;
    }
    .form-section {
      margin-bottom: 25px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    input, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      box-sizing: border-box;
    }
    textarea {
      height: 100px;
    }
    .add-btn, button {
      margin-top: 10px;
      padding: 10px;
      border: none;
      border-radius: 4px;
      color: #fff;
      cursor: pointer;
      font-size: 16px;
    }
    .add-btn {
      background-color: #27ae60;
    }
    .add-btn:hover {
      background-color: #219653;
    }
    button {
      background-color: #3498db;
    }
    button:hover {
      background-color: #2980b9;
    }
    .ats-score {
      text-align: center;
      margin-top: 20px;
      font-size: 1.2em;
      padding: 15px;
      border-radius: 5px;
    }
    .high-score {
      background-color: #d4edda;
      color: #155724;
    }
    .medium-score {
      background-color: #fff3cd;
      color: #856404;
    }
    .low-score {
      background-color: #f8d7da;
      color: #721c24;
    }
    #resumePreview {
      display: none;
      margin-top: 40px;
      border-top: 2px solid #ccc;
      padding-top: 20px;
    }
    #resumeContent {
      border: 1px solid #ddd;
      padding: 20px;
    }
    .keyword-match {
      display: inline-block;
      background-color: #d4edda;
      padding: 2px 5px;
      margin: 2px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    .keyword-miss {
      display: inline-block;
      background-color: #f8d7da;
      padding: 2px 5px;
      margin: 2px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    #keywordAnalysis {
      margin-top: 15px;
      padding: 10px;
      background-color: #f8f9fa;
      border-radius: 5px;
    }
  </style>
</head>
<body>

<h1>Resume Builder with ATS Tracker</h1>

<form id="resumeForm">
  <div class="form-section">
    <h2>Personal Information</h2>
    <label>Full Name:</label><input type="text" id="fullName" onkeyup="generateResume()" required>
    <label>Professional Title (Target Job):</label><input type="text" id="jobTitle" onkeyup="generateResume()" required>
    <label>Email:</label><input type="email" id="email" onkeyup="generateResume()" required>
    <label>Phone:</label><input type="tel" id="phone" onkeyup="generateResume()">
    <label>Website:</label><input type="url" id="website" onkeyup="generateResume()">
    <label>LinkedIn:</label><input type="url" id="linkedin" onkeyup="generateResume()">
    <label>GitHub:</label><input type="url" id="github" onkeyup="generateResume()">
  </div>

  <div class="form-section">
    <h2>Professional Summary</h2>
    <textarea id="summary" onkeyup="generateResume()" required></textarea>
  </div>

  <div class="form-section" id="experienceSection">
    <h2>Work Experience</h2>
    <div class="experience-item">
      <label>Job Title:</label><input type="text" name="jobTitle[]" onkeyup="generateResume()">
      <label>Company:</label><input type="text" name="company[]" onkeyup="generateResume()">
      <label>Dates:</label><input type="text" name="dates[]" placeholder="MM/YYYY - MM/YYYY" onkeyup="generateResume()">
      <label>Description:</label><textarea name="jobDescription[]" onkeyup="generateResume()"></textarea>
    </div>
    <button type="button" class="add-btn" onclick="addExperience()">Add Experience</button>
  </div>

  <div class="form-section" id="educationSection">
    <h2>Education</h2>
    <div class="education-item">
      <label>Degree:</label><input type="text" name="degree[]" onkeyup="generateResume()">
      <label>Institution:</label><input type="text" name="institution[]" onkeyup="generateResume()">
      <label>Dates:</label><input type="text" name="eduDates[]" placeholder="MM/YYYY - MM/YYYY" onkeyup="generateResume()">
    </div>
    <button type="button" class="add-btn" onclick="addEducation()">Add Education</button>
  </div>

  <div class="form-section">
    <h2>Skills</h2>
    <label>Technical Skills (comma separated):</label>
    <textarea id="techSkills" placeholder="e.g. HTML, CSS, JavaScript, React" onkeyup="generateResume()"></textarea>
    <label>Soft Skills (comma separated):</label>
    <textarea id="softSkills" placeholder="e.g. Leadership, Communication, Teamwork" onkeyup="generateResume()"></textarea>
  </div>

  <div class="form-section">
    <h2>Certifications</h2>
    <div id="certificationsSection">
      <div class="certification-item">
        <label>Certification Name:</label><input type="text" name="certName[]" onkeyup="generateResume()">
        <label>Issuing Organization:</label><input type="text" name="certOrg[]" onkeyup="generateResume()">
        <label>Date Earned:</label><input type="text" name="certDate[]" placeholder="MM/YYYY" onkeyup="generateResume()">
      </div>
    </div>
    <button type="button" class="add-btn" onclick="addCertification()">Add Certification</button>
  </div>

  <button type="button" onclick="generateResume()">Generate Resume & Calculate ATS Score</button>
</form>

<div id="atsScoreContainer">
  <div class="ats-score" id="atsScore"></div>
  <div id="keywordAnalysis"></div>
</div>

<div id="resumePreview">
  <h2>Generated Resume</h2>
  <div id="resumeContent"></div>
  <button onclick="downloadPDF()">Download as PDF</button>
  <button onclick="printCV()">Print Resume</button>
</div>

<script>
  // Enhanced job keywords database
  const jobKeywordsMap = {
    "web developer": {
      technical: ["HTML5", "CSS3", "JavaScript", "React", "Angular", "Vue.js", "Node.js", "Express", "REST APIs", "Git", "Responsive Design", "Web Accessibility", "Cross-browser Compatibility", "SEO", "Performance Optimization"],
      soft: ["Problem Solving", "Attention to Detail", "Collaboration", "Continuous Learning"],
      tools: ["VS Code", "Chrome DevTools", "Postman", "Figma", "Adobe XD"]
    },
    "data analyst": {
      technical: ["SQL", "Python", "R", "Excel", "Power BI", "Tableau", "Data Visualization", "ETL", "Data Cleaning", "Statistical Analysis", "Machine Learning", "Big Data"],
      soft: ["Analytical Thinking", "Communication", "Data Storytelling", "Business Acumen"],
      tools: ["Jupyter Notebooks", "Pandas", "NumPy", "scikit-learn", "TensorFlow"]
    },
    "project manager": {
      technical: ["Agile", "Scrum", "Kanban", "Waterfall", "Risk Management", "Budgeting", "Resource Allocation", "Project Planning"],
      soft: ["Leadership", "Communication", "Negotiation", "Stakeholder Management", "Conflict Resolution"],
      tools: ["JIRA", "Trello", "Asana", "MS Project", "Slack", "Confluence"]
    },
    "software engineer": {
      technical: ["Java", "Python", "C++", "OOP", "Data Structures", "Algorithms", "Design Patterns", "Testing", "Debugging", "CI/CD", "Microservices", "Cloud Computing"],
      soft: ["Problem Solving", "Teamwork", "Code Review", "Mentoring"],
      tools: ["Git", "Docker", "Kubernetes", "Jenkins", "AWS", "Azure"]
    },
    "graphic designer": {
      technical: ["Adobe Photoshop", "Illustrator", "InDesign", "Typography", "Color Theory", "Branding", "UI/UX Design", "Print Design"],
      soft: ["Creativity", "Attention to Detail", "Time Management", "Client Relations"],
      tools: ["Figma", "Sketch", "Adobe Creative Suite", "Canva"]
    }
  };

  // Add experience field
  function addExperience() {
    const div = document.createElement('div');
    div.className = 'experience-item';
    div.innerHTML = `
      <label>Job Title:</label><input type="text" name="jobTitle[]" onkeyup="generateResume()">
      <label>Company:</label><input type="text" name="company[]" onkeyup="generateResume()">
      <label>Dates:</label><input type="text" name="dates[]" placeholder="MM/YYYY - MM/YYYY" onkeyup="generateResume()">
      <label>Description:</label><textarea name="jobDescription[]" onkeyup="generateResume()"></textarea>
    `;
    document.getElementById('experienceSection').insertBefore(div, document.querySelector('#experienceSection .add-btn'));
  }

  // Add education field
  function addEducation() {
    const div = document.createElement('div');
    div.className = 'education-item';
    div.innerHTML = `
      <label>Degree:</label><input type="text" name="degree[]" onkeyup="generateResume()">
      <label>Institution:</label><input type="text" name="institution[]" onkeyup="generateResume()">
      <label>Dates:</label><input type="text" name="eduDates[]" placeholder="MM/YYYY - MM/YYYY" onkeyup="generateResume()">
    `;
    document.getElementById('educationSection').insertBefore(div, document.querySelector('#educationSection .add-btn'));
  }

  // Add certification field
  function addCertification() {
    const div = document.createElement('div');
    div.className = 'certification-item';
    div.innerHTML = `
      <label>Certification Name:</label><input type="text" name="certName[]" onkeyup="generateResume()">
      <label>Issuing Organization:</label><input type="text" name="certOrg[]" onkeyup="generateResume()">
      <label>Date Earned:</label><input type="text" name="certDate[]" placeholder="MM/YYYY" onkeyup="generateResume()">
    `;
    document.getElementById('certificationsSection').appendChild(div);
  }

  // Get ATS keywords for the target job
  function getATSKeywords(jobTitle) {
    const normalized = jobTitle.trim().toLowerCase();
    for (let key in jobKeywordsMap) {
      if (normalized.includes(key)) {
        return jobKeywordsMap[key];
      }
    }
    // Default to software engineer if no match found
    return jobKeywordsMap["software engineer"];
  }

  // Calculate ATS score
  function calculateATSScore(jobTitle, summary, techSkills, softSkills, jobDescriptions) {
    const keywords = getATSKeywords(jobTitle);
    const allContent = summary.toLowerCase() + " " + 
                      techSkills.toLowerCase() + " " + 
                      softSkills.toLowerCase() + " " + 
                      jobDescriptions.join(" ").toLowerCase();
    
    // Check for technical skills matches
    const techMatches = keywords.technical.filter(k => 
      allContent.includes(k.toLowerCase())
    );
    
    // Check for soft skills matches
    const softMatches = keywords.soft.filter(k => 
      allContent.includes(k.toLowerCase())
    );
    
    // Check for tools matches
    const toolsMatches = keywords.tools.filter(k => 
      allContent.includes(k.toLowerCase())
    );
    
    // Calculate scores for each category
    const techScore = keywords.technical.length > 0 ? 
      (techMatches.length / keywords.technical.length) * 50 : 0;
    const softScore = keywords.soft.length > 0 ? 
      (softMatches.length / keywords.soft.length) * 30 : 0;
    const toolsScore = keywords.tools.length > 0 ? 
      (toolsMatches.length / keywords.tools.length) * 20 : 0;
    
    // Total score (weighted average)
    const totalScore = Math.round(techScore + softScore + toolsScore);
    
    return {
      score: totalScore,
      techMatches,
      softMatches,
      toolsMatches,
      techMissed: keywords.technical.filter(k => !techMatches.includes(k)),
      softMissed: keywords.soft.filter(k => !softMatches.includes(k)),
      toolsMissed: keywords.tools.filter(k => !toolsMatches.includes(k))
    };
  }

  // Generate the resume and calculate ATS score
  function generateResume() {
    // Get form values
    const fullName = document.getElementById('fullName').value;
    const jobTitle = document.getElementById('jobTitle').value;
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    const website = document.getElementById('website').value;
    const linkedin = document.getElementById('linkedin').value;
    const github = document.getElementById('github').value;
    const summary = document.getElementById('summary').value;
    const techSkills = document.getElementById('techSkills').value;
    const softSkills = document.getElementById('softSkills').value;

    // Get all job descriptions from experience section
    const jobDescriptions = Array.from(document.getElementsByName('jobDescription[]'))
      .map(desc => desc.value);
    
    // Calculate ATS score
    const atsResult = calculateATSScore(jobTitle, summary, techSkills, softSkills, jobDescriptions);
    
    // Display ATS score with appropriate styling
    const scoreElement = document.getElementById('atsScore');
    scoreElement.innerHTML = `ATS Match Score: <strong>${atsResult.score}%</strong>`;
    
    // Apply color based on score
    if (atsResult.score >= 70) {
      scoreElement.className = 'ats-score high-score';
    } else if (atsResult.score >= 40) {
      scoreElement.className = 'ats-score medium-score';
    } else {
      scoreElement.className = 'ats-score low-score';
    }
    
    // Display keyword analysis
    const analysisElement = document.getElementById('keywordAnalysis');
    let analysisHTML = `
      <h3>Keyword Analysis</h3>
      <p><strong>Matched Keywords (${atsResult.techMatches.length + atsResult.softMatches.length + atsResult.toolsMatches.length})</strong></p>
      <div>
        ${atsResult.techMatches.map(k => `<span class="keyword-match">${k}</span>`).join('')}
        ${atsResult.softMatches.map(k => `<span class="keyword-match">${k}</span>`).join('')}
        ${atsResult.toolsMatches.map(k => `<span class="keyword-match">${k}</span>`).join('')}
      </div>
      <p><strong>Missing Keywords (${atsResult.techMissed.length + atsResult.softMissed.length + atsResult.toolsMissed.length})</strong></p>
      <div>
        ${atsResult.techMissed.map(k => `<span class="keyword-miss">${k}</span>`).join('')}
        ${atsResult.softMissed.map(k => `<span class="keyword-miss">${k}</span>`).join('')}
        ${atsResult.toolsMissed.map(k => `<span class="keyword-miss">${k}</span>`).join('')}
      </div>
      <p><em>Tip: Incorporate missing keywords naturally into your resume to improve your score.</em></p>
    `;
    analysisElement.innerHTML = analysisHTML;

    // Generate experience HTML
    const jobs = document.getElementsByName('jobTitle[]');
    const companies = document.getElementsByName('company[]');
    const dates = document.getElementsByName('dates[]');
    const jobDescs = document.getElementsByName('jobDescription[]');
    let expHTML = '';
    for (let i = 0; i < jobs.length; i++) {
      if (jobs[i].value.trim() !== '') {
        expHTML += `
          <div class="experience-item">
            <h4>${jobs[i].value}</h4>
            <p><strong>${companies[i].value}</strong> | ${dates[i].value}</p>
            <p>${jobDescs[i].value}</p>
          </div>
        `;
      }
    }

    // Generate education HTML
    const degrees = document.getElementsByName('degree[]');
    const institutions = document.getElementsByName('institution[]');
    const eduDates = document.getElementsByName('eduDates[]');
    let eduHTML = '';
    for (let i = 0; i < degrees.length; i++) {
      if (degrees[i].value.trim() !== '') {
        eduHTML += `
          <div class="education-item">
            <h4>${degrees[i].value}</h4>
            <p><strong>${institutions[i].value}</strong> | ${eduDates[i].value}</p>
          </div>
        `;
      }
    }

    // Generate certifications HTML
    const certNames = document.getElementsByName('certName[]');
    const certOrgs = document.getElementsByName('certOrg[]');
    const certDates = document.getElementsByName('certDate[]');
    let certHTML = '';
    for (let i = 0; i < certNames.length; i++) {
      if (certNames[i].value.trim() !== '') {
        certHTML += `
          <div class="certification-item">
            <h4>${certNames[i].value}</h4>
            <p><strong>${certOrgs[i].value}</strong> | ${certDates[i].value}</p>
          </div>
        `;
      }
    }

    // Generate skills HTML
    const techSkillsArray = techSkills.split(',').map(s => s.trim()).filter(s => s);
    const softSkillsArray = softSkills.split(',').map(s => s.trim()).filter(s => s);
    let skillsHTML = '';
    if (techSkillsArray.length > 0) {
      skillsHTML += `<p><strong>Technical Skills:</strong> ${techSkillsArray.join(', ')}</p>`;
    }
    if (softSkillsArray.length > 0) {
      skillsHTML += `<p><strong>Soft Skills:</strong> ${softSkillsArray.join(', ')}</p>`;
    }

    // Generate the resume HTML
    const resumeHTML = `
      <div id="pdf-content">
        <h1>${fullName}</h1>
        <h2>${jobTitle}</h2>
        <div class="contact-info">
          ${email ? `<p><strong>Email:</strong> ${email}</p>` : ''}
          ${phone ? `<p><strong>Phone:</strong> ${phone}</p>` : ''}
          ${website ? `<p><strong>Website:</strong> ${website}</p>` : ''}
          ${linkedin ? `<p><strong>LinkedIn:</strong> ${linkedin}</p>` : ''}
          ${github ? `<p><strong>GitHub:</strong> ${github}</p>` : ''}
        </div>
        <hr>
        ${summary ? `<div class="section"><h3>PROFESSIONAL SUMMARY</h3><p>${summary}</p></div>` : ''}
        ${skillsHTML ? `<div class="section"><h3>SKILLS</h3>${skillsHTML}</div>` : ''}
        ${expHTML ? `<div class="section"><h3>PROFESSIONAL EXPERIENCE</h3>${expHTML}</div>` : ''}
        ${eduHTML ? `<div class="section"><h3>EDUCATION</h3>${eduHTML}</div>` : ''}
        ${certHTML ? `<div class="section"><h3>CERTIFICATIONS</h3>${certHTML}</div>` : ''}
      </div>
    `;

    document.getElementById('resumeContent').innerHTML = resumeHTML;
    document.getElementById('resumePreview').style.display = 'block';
  }

  // Download as PDF
  function downloadPDF() {
    const element = document.getElementById('resumeContent');
    const opt = {
      margin: 10,
      filename: `${document.getElementById('fullName').value || 'resume'}.pdf`,
      image: { type: 'jpeg', quality: 0.98 },
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };
    html2pdf().set(opt).from(element).save();
  }

  // Print resume
  function printCV() {
    window.print();
  }

  // Initialize the form
  document.addEventListener('DOMContentLoaded', function() {
    // Add one empty experience and education field by default
    addExperience();
    addEducation();
    addCertification();
  });
</script>

</body>
</html>